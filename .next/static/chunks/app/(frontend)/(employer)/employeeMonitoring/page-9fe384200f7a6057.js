(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3932],{93986:(e,t,s)=>{Promise.resolve().then(s.bind(s,91017))},91017:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var a=s(95155),l=s(12115),r=s(35781),n=s(93137),c=s(76472),o=s(5565),i=s(76046);r.t1.register(r.Bs,r.m_,r.s$);let d=()=>{var e;let[t,s]=(0,l.useState)(null),[r,d]=(0,l.useState)("All"),[u,m]=(0,l.useState)(!1),[h,x]=(0,l.useState)(""),[g,p]=(0,l.useState)(""),[f,v]=(0,l.useState)(""),[b,j]=(0,l.useState)([]),y=(0,i.useRouter)(),[N,w]=(0,l.useState)("Daily"),[S,E]=(0,l.useState)(0),[I,A]=(0,l.useState)(0),[C,k]=(0,l.useState)(0),[F,T]=(0,l.useState)("All"),[R,O]=(0,l.useState)(""),[D,L]=(0,l.useState)(""),[M,P]=(0,l.useState)("ACTIVE"),[V,_]=(0,l.useState)("Idle"),[U,J]=(0,l.useState)(0),[q,B]=(0,l.useState)([]),z=async()=>{try{let e=await fetch("/employerAPI/employee");if(!e.ok)throw Error("Failed to fetch employees");let t=await e.json(),s=await fetch("/employerAPI/user");if(!s.ok)throw Error("Failed to fetch users");let a=await s.json(),l=t.map(e=>{let t=a.find(t=>t.email===e.email);return t?{...e,status:t.status,password:t.password,role:t.role}:e});j(l)}catch(e){console.error("Error fetching employees or users:",e)}};(0,l.useEffect)(()=>{localStorage.getItem("authToken")?z():y.push("/")},[]);let G=e=>{if(!e)return;let t=new EventSource("/employeeAPI/dashboard?employeeId=".concat(e));return console.log(t),t.onmessage=e=>{try{let t=JSON.parse(e.data);console.log(t),t&&0!==Object.keys(t).length?(E(t.idleTime||0),A(t.sleepingTime||0),k(t.totaltime||0),P(t.employeeStatus||"ACTIVE"),_(t.wakefulnessStatus||"Idle"),J(t.productivityPercentage||100)):(console.warn("No data received from SSE connection."),E(0),A(0),k(0),P("ACTIVE"),_("Idle"),J(0))}catch(e){P("ACTIVE"),_("Idle"),J(0),E(0),A(0),k(0)}},t.onerror=e=>{P("ACTIVE"),_("Idle"),J(0),E(0),A(0),k(0),t.close()},()=>{t.close()}};(0,l.useEffect)(()=>{if(console.log(t+"console here"),!t)return;let e=new EventSource("/employeeAPI/humanActivityLog?employeeId=".concat(t.employeeId));return e.onmessage=e=>{try{let t=JSON.parse(e.data);B(t)}catch(e){console.error("❌ Error parsing activity logs:",e)}},e.onerror=t=>{console.error("❌ SSE connection error:",t),e.close()},()=>{e.close()}},[t]);let H=e=>{switch(e){case"Idle":return"text-[#FFC107]";case"Active":return"text-green-500";case"On Leave":return"text-red-500";case"Sleeping":return"text-blue-500";default:return"text-gray-500"}},Y=b.filter(e=>("All"===r||e.status===r)&&e.name.toLowerCase().includes(h.toLowerCase()));return"All"===r||b.filter(e=>e.status===r),null==t||null===(e=t.activityLog)||void 0===e||e.filter(e=>{let t="All"===F||e.status===F,s=new Date(e.date),a=R?new Date(R):null,l=D?new Date(D):null;return t&&(!a||s>=a)&&(!l||s<=l)}),(0,a.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,a.jsx)(n.default,{}),(0,a.jsx)("div",{className:"container mx-auto p-4 mt-4",children:(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"w-[30%] bg-white shadow-lg p-6 rounded-lg h-auto",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-700",children:"Employee List"}),(0,a.jsx)("input",{type:"text",placeholder:"Search employee...",value:h,onChange:e=>x(e.target.value),className:"mt-3 w-full p-2 border bg-white rounded-md text-gray-700"}),(0,a.jsxs)("select",{className:"mt-3 w-full p-2 border bg-white rounded-md text-gray-700",value:r,onChange:e=>d(e.target.value),children:[(0,a.jsx)("option",{value:"All",children:"All"}),(0,a.jsx)("option",{value:"ACTIVE",children:"Active"}),(0,a.jsx)("option",{value:"INACTIVE",children:"Idle"}),(0,a.jsx)("option",{value:"On Meeting",children:"On Meeting"})]}),(0,a.jsx)("div",{className:"mt-4 space-y-3 overflow-y-auto max-h-[650px]",children:Y.slice(0,9).map(e=>(0,a.jsxs)("div",{className:"p-4 bg-gray-100 rounded-lg shadow-md cursor-pointer hover:bg-gray-200 transition-all duration-200 flex items-center",onClick:()=>{s(e),G(e.employeeId)},children:[(0,a.jsx)(o.default,{src:"/img/user-icon.png",alt:"User Icon",width:60,height:60,className:"w-14 h-14 mr-4"}),(0,a.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:e.name}),(0,a.jsx)("p",{className:"text-sm font-medium ".concat(H(e.activityStatus)),children:e.activityStatus})]})]},e.id))})]}),(0,a.jsxs)("div",{className:"w-[70%] flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"card bg-white shadow-md text-black p-10",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Productivity vs Idle Time vs Sleeping Time"}),(0,a.jsx)("h3",{className:"text-xl font-bold mb-4",children:null==t?void 0:t.name}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"dateRange",className:"text-sm font-medium bg-white",children:"Filter by: "}),(0,a.jsxs)("select",{id:"dateRange",value:N,onChange:e=>{w(e.target.value),"Date Range"===e.target.value&&(p("2025-01-01"),v("2025-01-31"),m(!0))},className:"mt-2 border p-2 rounded bg-white",children:[(0,a.jsx)("option",{value:"Daily",children:"Daily"}),(0,a.jsx)("option",{value:"Monthly",children:"Monthly"}),(0,a.jsx)("option",{value:"Date Range",children:"Date Range"})]})]}),(0,a.jsx)("div",{className:"flex justify-center items-center w-full h-full",children:(0,a.jsx)("div",{className:"w-80 h-80",children:(0,a.jsx)(c.nu,{data:(()=>{if(0===C)return{labels:["No Data"],datasets:[{data:[1,1,1],backgroundColor:["#e0e0e0"]}]};let e=S/C*100,t=I/C*100;return{labels:["Productive Tasks","Idle Time","Sleeping"],datasets:[{data:[100-e-t,e,t],backgroundColor:["#4CAF50","#FFC107","#F44336"],hoverBackgroundColor:["#45a049","#ffca2c","#e53935"]}]}})()})})})]}),(0,a.jsx)("div",{className:"flex flex-col md:flex-row gap-4",children:(0,a.jsxs)("div",{className:"w-full md:w-full bg-white shadow-lg p-6 rounded-lg min-h-[300px]",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold pb-3 text-gray-700",children:"HUMAN ACTIVITY RECOGNITION"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Alertness Report & Real-Time Alert Log."}),(0,a.jsxs)("div",{className:"mt-4 p-3 bg-gray-100 rounded-lg h-80 overflow-auto text-sm",children:[(0,a.jsx)("h3",{className:"text-md font-semibold text-gray-700 mb-2",children:"Real-Time Log:"}),(0,a.jsx)("ul",{className:"space-y-2",children:q.length>0?q.map((e,t)=>(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"font-medium text-gray-500",children:e.activity}),(0,a.jsxs)("span",{className:"text-gray-500 text-xs ml-2",children:[e.start," - ",e.end?e.end:"Ongoing"]})]},t)):(0,a.jsx)("p",{className:"text-gray-500",children:"No logs available."})})]})]})})]})]})})})]})}},93137:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var a=s(95155),l=s(48173),r=s.n(l),n=s(12115),c=s(76046),o=s(689),i=s(87936),d=s(21354),u=s(13261),m=s(5565);let h=()=>{let[e,t]=(0,n.useState)(!1),[s,l]=(0,n.useState)(!1),[h,x]=(0,n.useState)(!1),[g,p]=(0,n.useState)(null),[f,v]=(0,n.useState)(!1),b=(0,c.useRouter)(),j=(0,c.usePathname)(),y={"/employerDashboard":"Dashboard","/employeeMonitoring":"Employee Monitoring","/approvalRequest":"Approval Request","/manageEmployee":"Manage Employee","/employerReports":"Reports","/screenCaptureMonitoring":"Screen Capture"},N=y[j]||"Dashboard";return(0,n.useEffect)(()=>{let e=localStorage.getItem("user");e&&p(JSON.parse(e))},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("nav",{className:"bg-white shadow-md text-gray-600 relative z-50",children:[(0,a.jsxs)("div",{className:"container mx-auto px-4 py-3 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("button",{className:"md:hidden text-red mr-3",onClick:()=>t(!e),children:e?(0,a.jsx)(o.A,{className:"w-6 h-6"}):(0,a.jsx)(i.A,{className:"w-6 h-6"})}),(0,a.jsx)("div",{className:"hidden md:flex space-x-6",children:Object.keys(y).map(e=>(0,a.jsx)(r(),{href:e,className:"".concat(j===e?"bg-[#FFFFFF] text-gray-700 font-semibold text-lg":"text-gray-400 text-base"," hover:bg-[#FFFFFF] hover:text-black px-2 py-2 rounded"),children:y[e]},e))})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{className:"flex items-center space-x-2 text-black",onClick:()=>l(!s),children:[(0,a.jsx)("div",{className:"avatar avatar-online",children:(0,a.jsx)("div",{className:"w-9 h-9 rounded-full ring ",children:(0,a.jsx)(m.default,{src:"/img/user-icon.png",alt:"User Icon",width:60,height:60,className:"w-14 h-14 mr-4"})})}),(0,a.jsx)("span",{className:"text-gray-600",children:g?g.name:"Loading..."})]}),s&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white text-black rounded-lg shadow-lg",children:[(0,a.jsxs)("div",{className:"p-2 border-b",children:[(0,a.jsx)("p",{className:"text-sm font-semibold",children:g?g.name:"Unknown"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:g?g.email:"No Email"})]}),(0,a.jsxs)("button",{onClick:()=>{l(!1),x(!0),setTimeout(()=>{x(!1),localStorage.removeItem("user"),localStorage.removeItem("authToken"),b.push("/")},2e3)},className:"w-full text-left px-4 py-2 text-red-600 hover:bg-gray-100 flex items-center",children:[(0,a.jsx)(d.A,{className:"w-5 h-5 mr-2"}),"Logout"]})]})]})]}),(0,a.jsx)("div",{className:"".concat(e?"block":"hidden"," md:hidden bg-[#135D66] py-2"),children:Object.keys(y).map(e=>(0,a.jsx)(r(),{href:e,className:"".concat(j===e?"bg-[#0F4A55]":""," block px-4 py-2 text-white hover:bg-[#0F4A55]"),children:y[e]},e))}),h&&(0,a.jsxs)("div",{className:"absolute top-4 right-4 bg-green-600 text-white p-3 rounded-lg shadow-lg flex items-center",children:[(0,a.jsx)(u.A,{className:"w-5 h-5 mr-2"}),"Logging out..."]})]}),(0,a.jsx)("div",{className:"container mx-auto mt-6 p-6 bg-gray-700 shadow-xl flex justify-between items-center",children:(0,a.jsx)("h1",{className:"text-xl font-semibold text-white",children:N})})]})}},76472:(e,t,s)=>{"use strict";s.d(t,{N1:()=>d,nu:()=>u});var a=s(12115),l=s(35781);let r="label";function n(e,t){"function"==typeof e?e(t):e&&(e.current=t)}function c(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,a=[];e.datasets=t.map(t=>{let l=e.datasets.find(e=>e[s]===t[s]);return!l||!t.data||a.includes(l)?{...t}:(a.push(l),Object.assign(l,t),l)})}let o=(0,a.forwardRef)(function(e,t){let{height:s=150,width:o=300,redraw:i=!1,datasetIdKey:d,type:u,data:m,options:h,plugins:x=[],fallbackContent:g,updateMode:p,...f}=e,v=(0,a.useRef)(null),b=(0,a.useRef)(null),j=()=>{v.current&&(b.current=new l.t1(v.current,{type:u,data:function(e){var t;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,a={labels:[],datasets:[]};return t=e.labels,a.labels=t,c(a,e.datasets,s),a}(m,d),options:h&&{...h},plugins:x}),n(t,b.current))},y=()=>{n(t,null),b.current&&(b.current.destroy(),b.current=null)};return(0,a.useEffect)(()=>{!i&&b.current&&h&&function(e,t){let s=e.options;s&&t&&Object.assign(s,t)}(b.current,h)},[i,h]),(0,a.useEffect)(()=>{if(!i&&b.current){var e,t;e=b.current.config.data,t=m.labels,e.labels=t}},[i,m.labels]),(0,a.useEffect)(()=>{!i&&b.current&&m.datasets&&c(b.current.config.data,m.datasets,d)},[i,m.datasets]),(0,a.useEffect)(()=>{b.current&&(i?(y(),setTimeout(j)):b.current.update(p))},[i,h,m.labels,m.datasets,p]),(0,a.useEffect)(()=>{b.current&&(y(),setTimeout(j))},[u]),(0,a.useEffect)(()=>(j(),()=>y()),[]),a.createElement("canvas",{ref:v,role:"img",height:s,width:o,...f},g)});function i(e,t){return l.t1.register(t),(0,a.forwardRef)((t,s)=>a.createElement(o,{...t,ref:s,type:e}))}let d=i("line",l.ZT),u=i("doughnut",l.ju)}},e=>{var t=t=>e(e.s=t);e.O(0,[5647,8376,2675,8441,1517,7358],()=>t(93986)),_N_E=e.O()}]);