(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2478],{80098:(e,t,a)=>{Promise.resolve().then(a.bind(a,28005))},28005:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var l=a(95155),s=a(93137),r=a(12115),c=a(72757),d=a(76046),n=a(54655);let i=()=>{let[e,t]=(0,r.useState)(1),[a,i]=(0,r.useState)(""),[o,m]=(0,r.useState)(""),[x,u]=(0,r.useState)([]),[h,p]=(0,r.useState)([]),[b,y]=(0,r.useState)(!0),[g,j]=(0,r.useState)(null),f=(0,d.useRouter)(),N=(0,r.useRef)(null),[v,w]=(0,r.useState)([]),[k,S]=(0,r.useState)([]),[D,A]=(0,r.useState)([]),[C,E]=(0,r.useState)(!1),[R,T]=(0,r.useState)(null),[F,I]=(0,r.useState)([]),[P,O]=(0,r.useState)(""),_=e=>{j(g===e?null:e)};(0,r.useEffect)(()=>{localStorage.getItem("authToken")?M():f.push("/")},[]);let L=()=>{j(null)},M=async()=>{try{let e=await fetch("/employerAPI/notifications");if(!e.ok)throw Error("Failed to fetch notifications");let t=await e.json(),a=await fetch("/employerAPI/employee");if(!a.ok)throw Error("Failed to fetch employees");let l=await a.json();A(l);let s={};l.forEach(e=>{s[e.employeeId]=e.name});let r=(t.pending||[]).sort((e,t)=>new Date(t.createdAt)-new Date(e.createdAt)).map(e=>({...e,employeeName:s[e.employeeId]||"Unknown"}));S(r),y(!1)}catch(e){console.error("Error fetching data:",e),S([]),y(!1)}};console.log(k);let U=e=>{T(e),E(!0),j(null),console.log(e)},J=5*e;h.slice(J-5,J);let V=Math.ceil(h.length/5);return(0,l.jsxs)("div",{className:"min-h-screen shadow-md bg-white",children:[(0,l.jsx)(s.default,{}),(0,l.jsx)("div",{className:"container mx-auto p-2 mt-2",children:(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("h1",{children:"Filter By:"}),(0,l.jsx)("input",{type:"date",value:a,onChange:e=>i(e.target.value),className:"px-4 py-2 border rounded-md"}),(0,l.jsx)("span",{children:"to"}),(0,l.jsx)("input",{type:"date",value:o,onChange:e=>m(e.target.value),className:"px-4 py-2 border rounded-md"}),(0,l.jsx)("button",{onClick:()=>{p(x.filter(e=>{let t=new Date(e.createdAt),l=a?new Date(a):null,s=o?new Date(o):null;return(!l||t>=l)&&(!s||t<=s)})),t(1)},className:"bg-blue-600 text-white px-4 py-2 rounded-md",children:"Filter"})]})}),(0,l.jsx)("div",{className:"grid grid-cols-1",children:(0,l.jsxs)("div",{className:"card bg-white shadow-xl text-black p-10",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"REQUESTS LOG"}),(0,l.jsx)("div",{className:"overflow-x-auto min-h-[450px]",children:(0,l.jsxs)("table",{className:"table table-xs",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-gray-200",children:[(0,l.jsx)("th",{className:"px-4 py-2 border-b text-black text-center",children:"Date"}),(0,l.jsx)("th",{className:"px-4 py-2 border-b text-black text-center",children:"Type"}),(0,l.jsx)("th",{className:"px-4 py-2 border-b text-black text-center",children:"Name"}),(0,l.jsx)("th",{className:"px-4 py-2 border-b text-black text-center",children:"Employee ID"}),(0,l.jsx)("th",{className:"px-4 py-2 border-b text-black text-center",children:"Status"}),(0,l.jsx)("th",{className:"px-4 py-2 border-b text-black text-center",children:"Action"})]})}),(0,l.jsx)("tbody",{children:b?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:"5",className:"text-center py-4",children:"Loading..."})}):k.length>0?k.map(e=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"px-4 py-2 border-b text-black text-center",children:new Date(e.createdAt).toLocaleDateString()}),(0,l.jsx)("td",{className:"px-4 py-2 border-b text-black text-center",children:e.file_type}),(0,l.jsx)("td",{className:"px-4 py-2 border-b text-black text-center",children:e.employeeName}),(0,l.jsx)("td",{className:"px-4 py-2 border-b text-black text-center",children:e.employeeId}),(0,l.jsx)("td",{className:"px-4 py-2 border-b text-black text-center ".concat("PENDING"===e.status?"text-yellow-600":"APPROVED"===e.status?"text-green-600":"text-red-600"),children:e.status}),(0,l.jsx)("td",{className:"px-4 py-2 border-b text-black text-center relative",children:(0,l.jsxs)("div",{className:"relative inline-block",ref:N,onMouseLeave:L,children:[(0,l.jsx)("button",{className:"p-2 rounded-md hover:bg-gray-200",onClick:()=>_(e.id),children:(0,l.jsx)(c.A,{className:"w-5 h-5"})}),g===e.id&&(0,l.jsxs)("div",{className:"absolute right-0 w-32 bg-white border rounded-md shadow-md z-10",children:[(0,l.jsx)("button",{className:"block px-4 py-2 w-full text-left hover:bg-gray-100",onClick:()=>{U(e)},children:"View"}),(0,l.jsx)("button",{className:"block px-4 py-2 w-full text-left hover:bg-gray-100",onClick:()=>{setDeleteEmployee(e),setIsDeleting(!0)},children:"Delete"}),(0,l.jsx)("button",{className:"block px-4 py-2 w-full text-left hover:bg-gray-100",onClick:()=>{openModal(emp)},children:"View Attendance"})]})]})})]},e.id)):(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:"5",className:"text-center py-4",children:"No requests found."})})})]})}),V>1&&(0,l.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,l.jsx)("button",{className:"px-4 py-2 bg-gray-500 text-white rounded",onClick:()=>t(e-1),disabled:1===e,children:"Previous"}),(0,l.jsxs)("div",{className:"text-center text-black",children:["Page ",e," of ",V]}),(0,l.jsx)("button",{className:"px-4 py-2 bg-gray-500 text-white rounded",onClick:()=>t(e+1),disabled:e===V,children:"Next"})]})]})})]})}),(0,l.jsx)(n.default,{isOpen:C,onClose:()=>{E(!1),T(null)},record:R,refresh:M,setMessage:e=>{O(e)}})]})}},54655:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});var l=a(95155),s=a(12115);let r=e=>{let{isOpen:t,onClose:a,record:r,refresh:c,setMessage:d}=e,[n,i]=(0,s.useState)(""),[o,m]=(0,s.useState)(""),[x,u]=(0,s.useState)(""),[h,p]=(0,s.useState)(""),[b,y]=(0,s.useState)(!1),[g,j]=(0,s.useState)("");if((0,s.useEffect)(()=>{r?(i("DTRP"===r.file_type?r.type:r.leaveType),m(r.date?new Date(r.date).toISOString().slice(0,16):""),u("DTRP"===r.file_type?r.remarks:r.reason),p(r.reason||"")):(i(""),m(""),u(""),p(""))},[r]),!t)return null;let f=async e=>{e.preventDefault(),y(!0),j("");let t=localStorage.getItem("authToken");JSON.parse(localStorage.getItem("user")||"{}");let l=r.employeeId,s=r?{id:r.id,type:n,dateTime:o,remarks:x,file_type:r.file_type,employeeId:l,reason:r.reason,approval:"APPROVED",leaveStart:r.startDate,leaveEnd:r.endDate}:{employeeId:l,type:n,dateTime:o,remarks:x};try{if(!(await fetch("/employerAPI/approval",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(r?{...s,id:r.id}:s)})).ok)throw Error("Failed to submit Record");void 0!=s.id?d("Record Updated Successfully!"):d("Record Added Successfully!"),c(),a()}catch(e){console.error("Error submitting Record:",e),d("Failed to submit Record.")}finally{y(!1)}},N=async e=>{e.preventDefault(),y(!0),j("");let t=localStorage.getItem("authToken"),l=JSON.parse(localStorage.getItem("user")||"{}"),s=null==l?void 0:l.employeeId,i=r?{id:r.id,type:n,dateTime:o,remarks:x}:{employeeId:s,type:n,dateTime:o,remarks:x};try{if(!(await fetch("/employeeAPI/dtrp",{method:r?"PATCH":"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(r?{...i,id:r.id}:i)})).ok)throw Error("Failed to submit Record");void 0!=i.id?d("Record Updated Successfully!"):d("Record Added Successfully!"),c(),a()}catch(e){console.error("Error submitting Record:",e),d("Failed to submit Record.")}finally{y(!1)}};return(0,l.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 text-black",children:(0,l.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"DTRP"==r.file_type?"Daily Time Record Problem":"Leave2 "}),(0,l.jsx)("label",{className:"block mb-2 font-medium",children:" Type"}),"DTRP"===r.file_type?(0,l.jsxs)("select",{className:"w-full px-4 py-2 border rounded-md mb-4 bg-gray-200 cursor-not-allowed",value:n,onChange:e=>i(e.target.value),disabled:!0,children:[(0,l.jsx)("option",{value:"time-in",children:"Time In"}),(0,l.jsx)("option",{value:"time-out",children:"Time Out"})]}):(0,l.jsx)("input",{type:"text",className:"w-full px-4 py-2 border rounded-md mb-4 bg-gray-200 cursor-not-allowed",value:r.leaveType,disabled:!0}),(0,l.jsx)("label",{className:"block mb-2 font-medium",children:"DTRP"===r.file_type?"Date & Time":"Date Covered"}),"DTRP"===r.file_type?(0,l.jsx)("input",{type:"datetime-local",className:"w-full px-4 py-2 border rounded-md mb-4 bg-white",value:o,onChange:e=>m(e.target.value),disabled:!0}):(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block mb-2 font-medium",children:"Start Date"}),(0,l.jsx)("input",{type:"text",className:"w-full px-4 py-2 border rounded-md mb-4 bg-gray-200 cursor-not-allowed",value:r.startDate,disabled:!0}),(0,l.jsx)("label",{className:"block mb-2 font-medium",children:"End Date"}),(0,l.jsx)("input",{type:"text",className:"w-full px-4 py-2 border rounded-md mb-4 bg-gray-200 cursor-not-allowed",value:r.endDate,disabled:!0})]}),(0,l.jsx)("label",{className:"block mb-2 font-medium",children:"Remarks"}),(0,l.jsx)("textarea",{className:"w-full px-4 py-2 border rounded-md mb-4 bg-white",rows:3,placeholder:"Enter remarks...",value:x,onChange:e=>u(e.target.value),disabled:!0}),(0,l.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,l.jsx)("button",{onClick:a,className:"px-4 py-2 bg-blue-500 text-white rounded-md",children:"Close"}),(0,l.jsx)("button",{onClick:f,className:"px-4 py-2 bg-green-500 text-white rounded-md",children:b?"Submitting...":r?"Approved":"Submit"}),(0,l.jsx)("button",{onClick:N,className:"px-4 py-2 bg-red-500 text-white rounded-md",children:b?"Submitting...":r?"Disapproved":"Submit"})]})]})})}},93137:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var l=a(95155),s=a(48173),r=a.n(s),c=a(12115),d=a(76046),n=a(689),i=a(87936),o=a(21354),m=a(13261),x=a(5565);let u=()=>{let[e,t]=(0,c.useState)(!1),[a,s]=(0,c.useState)(!1),[u,h]=(0,c.useState)(!1),[p,b]=(0,c.useState)(null),[y,g]=(0,c.useState)(!1),j=(0,d.useRouter)(),f=(0,d.usePathname)(),N={"/employerDashboard":"Dashboard","/employeeMonitoring":"Employee Monitoring","/approvalRequest":"Approval Request","/manageEmployee":"Manage Employee","/employerReports":"Reports","/screenCaptureMonitoring":"Screen Capture"},v=N[f]||"Dashboard";return(0,c.useEffect)(()=>{let e=localStorage.getItem("user");e&&b(JSON.parse(e))},[]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("nav",{className:"bg-white shadow-md text-gray-600 relative z-50",children:[(0,l.jsxs)("div",{className:"container mx-auto px-4 py-3 flex justify-between items-center",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("button",{className:"md:hidden text-red mr-3",onClick:()=>t(!e),children:e?(0,l.jsx)(n.A,{className:"w-6 h-6"}):(0,l.jsx)(i.A,{className:"w-6 h-6"})}),(0,l.jsx)("div",{className:"hidden md:flex space-x-6",children:Object.keys(N).map(e=>(0,l.jsx)(r(),{href:e,className:"".concat(f===e?"bg-[#FFFFFF] text-gray-700 font-semibold text-lg":"text-gray-400 text-base"," hover:bg-[#FFFFFF] hover:text-black px-2 py-2 rounded"),children:N[e]},e))})]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("button",{className:"flex items-center space-x-2 text-black",onClick:()=>s(!a),children:[(0,l.jsx)("div",{className:"avatar avatar-online",children:(0,l.jsx)("div",{className:"w-9 h-9 rounded-full ring ",children:(0,l.jsx)(x.default,{src:"/img/user-icon.png",alt:"User Icon",width:60,height:60,className:"w-14 h-14 mr-4"})})}),(0,l.jsx)("span",{className:"text-gray-600",children:p?p.name:"Loading..."})]}),a&&(0,l.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white text-black rounded-lg shadow-lg",children:[(0,l.jsxs)("div",{className:"p-2 border-b",children:[(0,l.jsx)("p",{className:"text-sm font-semibold",children:p?p.name:"Unknown"}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:p?p.email:"No Email"})]}),(0,l.jsxs)("button",{onClick:()=>{s(!1),h(!0),setTimeout(()=>{h(!1),localStorage.removeItem("user"),localStorage.removeItem("authToken"),j.push("/")},2e3)},className:"w-full text-left px-4 py-2 text-red-600 hover:bg-gray-100 flex items-center",children:[(0,l.jsx)(o.A,{className:"w-5 h-5 mr-2"}),"Logout"]})]})]})]}),(0,l.jsx)("div",{className:"".concat(e?"block":"hidden"," md:hidden bg-[#135D66] py-2"),children:Object.keys(N).map(e=>(0,l.jsx)(r(),{href:e,className:"".concat(f===e?"bg-[#0F4A55]":""," block px-4 py-2 text-white hover:bg-[#0F4A55]"),children:N[e]},e))}),u&&(0,l.jsxs)("div",{className:"absolute top-4 right-4 bg-green-600 text-white p-3 rounded-lg shadow-lg flex items-center",children:[(0,l.jsx)(m.A,{className:"w-5 h-5 mr-2"}),"Logging out..."]})]}),(0,l.jsx)("div",{className:"container mx-auto mt-6 p-6 bg-gray-700 shadow-xl flex justify-between items-center",children:(0,l.jsx)("h1",{className:"text-xl font-semibold text-white",children:v})})]})}},72757:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});let l=(0,a(14057).A)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[8376,8441,1517,7358],()=>t(80098)),_N_E=e.O()}]);