(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1629],{6715:(e,t,s)=>{Promise.resolve().then(s.bind(s,36050))},36050:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var l=s(95155),a=s(58640),r=s(12115),n=s(76472),c=s(35781),i=s(76046);c.t1.register(c.Bs,c.m_,c.s$);let d=()=>{let[e,t]=(0,r.useState)("ACTIVE"),[s,c]=(0,r.useState)("Idle"),[d,o]=(0,r.useState)(0),[u,m]=(0,r.useState)([]),[h,x]=(0,r.useState)([]),g=(0,i.useRouter)(),p=localStorage.getItem("user"),b=p?JSON.parse(p):null,f=null==b?void 0:b.employeeId,[j,v]=(0,r.useState)(0),[N,y]=(0,r.useState)(0),[w,S]=(0,r.useState)(0),[C,E]=(0,r.useState)("Daily"),[I,k]=(0,r.useState)(!1),[T,D]=(0,r.useState)(""),[A,R]=(0,r.useState)("");(0,r.useEffect)(()=>{localStorage.getItem("authToken")?O():g.push("/")},[]);let O=async()=>{try{if(!f)return;let e=await fetch("/employeeAPI/notifications?employeeId=".concat(f)),t=await e.json();m(t.latest||[]),x(t.pending||[])}catch(e){console.error("Error fetching notification logs:",e),m([]),x([])}};(0,r.useEffect)(()=>{if(!f)return;let e=new EventSource("/employeeAPI/dashboard?employeeId=".concat(f));return e.onmessage=e=>{try{let s=JSON.parse(e.data);s&&0!==Object.keys(s).length?(v(s.idleTime||0),y(s.sleepingTime||0),S(s.totaltime||0),t(s.employeeStatus||"ACTIVE"),c(s.wakefulnessStatus||"Idle"),o(s.productivityPercentage||100)):(console.warn("No data received from SSE connection."),v(0),y(0),S(0),t("ACTIVE"),c("Idle"),o(0))}catch(e){t("ACTIVE"),c("Idle"),o(0),v(0),y(0),S(0)}},e.onerror=s=>{t("ACTIVE"),c("Idle"),o(0),v(0),y(0),S(0),e.close()},()=>{e.close()}},[f]);let P=e=>{"DTRP"===e?g.push("/dtr-problem"):"Overtime"===e?g.push("/overtime"):"Leave"===e&&g.push("/leaves")},F=()=>{k(!1)};return(0,l.jsxs)("div",{className:"min-h-screen shadow-md bg-white",children:[(0,l.jsx)(a.default,{}),(0,l.jsx)("div",{className:"container mx-auto p-2 mt-2",children:(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"flex-1 bg-white shadow-lg rounded-lg p-4 text-gray-700",children:[(0,l.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Employee Activity & Productivity"}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Activity:"}),(0,l.jsx)("span",{className:"ml-2 px-2 py-1 rounded text-white text-xs ".concat("ACTIVE"===e?"bg-green-500":"bg-red-500"),children:e})]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Productivity:"}),(0,l.jsxs)("span",{className:"ml-2 px-2 py-1 rounded text-white text-xs ".concat(d<=50?"bg-red-500":"bg-green-500"),children:[d,"%"]})]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Wakefulness:"}),(0,l.jsx)("span",{className:"ml-2 px-2 py-1 rounded text-white text-xs ".concat("Awake"===s?"bg-green-500":"Idle"===s?"bg-yellow-500":"Sleeping"===s?"bg-red-500":"bg-gray-500"),children:s})]})]}),(0,l.jsxs)("div",{className:"card bg-white shadow-md text-black p-10",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold",children:"Quick Access"}),(0,l.jsxs)("ul",{className:"space-y-2",children:[(0,l.jsx)("li",{children:(0,l.jsx)("a",{href:"/dtr-problem",className:"text-blue-500 hover:underline",children:"Daily Time Record Problems"})}),(0,l.jsx)("li",{children:(0,l.jsx)("a",{href:"/leaves",className:"text-blue-500 hover:underline",children:"Leaves"})}),(0,l.jsx)("li",{children:(0,l.jsx)("a",{href:"/overtime",className:"text-blue-500 hover:underline",children:"Overtime"})})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"card bg-white shadow-md text-black p-10",children:[(0,l.jsx)("h1",{className:"text-xl font-bold mb-4",children:"NOTIFICATION LOGS"}),(0,l.jsx)("h2",{className:"font-semibold text-lg ",children:"Latest Requests"}),(0,l.jsx)("hr",{className:"my-2 border-gray-300"}),u.length>0?(0,l.jsx)("div",{className:"mb-4",children:["Leave","Overtime","DTRP"].map(e=>{let t=u.filter(t=>t.type===e).slice(0,2);return(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("h4",{className:"font-semibold text-[12px]",children:e}),t.length>0?(0,l.jsx)("ul",{children:t.map((e,t)=>(0,l.jsxs)("li",{onClick:()=>P(e.type),className:"text-blue-600 border-b py-2 cursor-pointer hover:text-blue-300 text-[10px]",children:[e.status," (",new Date(e.createdAt).toLocaleString(),")"]},t))}):(0,l.jsxs)("p",{className:"text-gray-500",children:["No recent ",e.toLowerCase()," requests"]})]},e)})}):(0,l.jsx)("p",{children:"No recent requests"}),(0,l.jsx)("h3",{className:"font-semibold text-lg ",children:"Pending Requests"}),(0,l.jsx)("hr",{className:"my-2 border-gray-300"}),h.length>0?(0,l.jsx)("div",{children:["Leave","Overtime","DTRP"].map(e=>{let t=h.filter(t=>t.type===e).slice(0,2);return(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("h4",{className:"font-semibold text-[12px]",children:e}),t.length>0?(0,l.jsx)("ul",{children:t.map((e,t)=>(0,l.jsxs)("li",{onClick:()=>P(e.type),className:"text-blue-600 border-b py-2 cursor-pointer hover:text-blue-300 text-[10px]",children:[e.status," (",new Date(e.createdAt).toLocaleString(),")"]},t))}):(0,l.jsxs)("p",{className:"text-gray-500",children:["No pending ",e.toLowerCase()," requests"]})]},e)})}):(0,l.jsx)("p",{children:"No pending requests"})]}),(0,l.jsxs)("div",{className:"card bg-white shadow-md text-black p-10",children:[(0,l.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Productivity vs Idle Time vs Sleeping Time"}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{htmlFor:"dateRange",className:"text-sm font-medium",children:"Filter by: "}),(0,l.jsxs)("select",{id:"dateRange",value:C,onChange:e=>{E(e.target.value),"Date Range"===e.target.value&&(D("2025-01-01"),R("2025-01-31"),k(!0))},className:"mt-2 border p-2 rounded",children:[(0,l.jsx)("option",{value:"Daily",children:"Daily"}),(0,l.jsx)("option",{value:"Monthly",children:"Monthly"}),(0,l.jsx)("option",{value:"Date Range",children:"Date Range"})]})]}),(0,l.jsx)("div",{className:"flex justify-center items-center w-full h-full",children:(0,l.jsx)("div",{className:"w-80 h-80",children:(0,l.jsx)(n.nu,{data:(()=>{if(0===w)return{labels:["No Data"],datasets:[{data:[1,1,1],backgroundColor:["#e0e0e0"]}]};let e=j/w*100,t=N/w*100;return{labels:["Productive Tasks","Idle Time","Sleeping"],datasets:[{data:[100-e-t,e,t],backgroundColor:["#4CAF50","#FFC107","#F44336"],hoverBackgroundColor:["#45a049","#ffca2c","#e53935"]}]}})()})})})]})]})]})}),I&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:(0,l.jsxs)("div",{className:"bg-white p-6 rounded-lg w-94",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Selected Date Range"}),(0,l.jsx)("div",{className:"space-y-4 mb-4",children:(0,l.jsxs)("div",{className:"flex justify-between space-x-2",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("label",{htmlFor:"startDate",className:"text-sm font-medium",children:"Date From:"}),(0,l.jsx)("input",{id:"startDate",type:"date",value:T,onChange:e=>D(e.target.value),className:"mt-2 border p-2 rounded w-full"})]}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("label",{htmlFor:"endDate",className:"text-sm font-medium",children:"Date To:"}),(0,l.jsx)("input",{id:"endDate",type:"date",value:A,onChange:e=>R(e.target.value),className:"mt-2 border p-2 rounded w-full"})]})]})}),(0,l.jsxs)("div",{className:"flex space-x-4 mt-4",children:[(0,l.jsx)("button",{onClick:F,className:"px-8 py-2 bg-red-500 text-white rounded w-full sm:w-auto ml-60",children:"Exit"}),(0,l.jsx)("button",{onClick:F,className:"px-8 py-2 bg-blue-500 text-white rounded w-full sm:w-auto ml-auto",children:"OK"})]})]})})]})}},32645:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(14057).A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},76472:(e,t,s)=>{"use strict";s.d(t,{N1:()=>o,nu:()=>u});var l=s(12115),a=s(35781);let r="label";function n(e,t){"function"==typeof e?e(t):e&&(e.current=t)}function c(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,l=[];e.datasets=t.map(t=>{let a=e.datasets.find(e=>e[s]===t[s]);return!a||!t.data||l.includes(a)?{...t}:(l.push(a),Object.assign(a,t),a)})}let i=(0,l.forwardRef)(function(e,t){let{height:s=150,width:i=300,redraw:d=!1,datasetIdKey:o,type:u,data:m,options:h,plugins:x=[],fallbackContent:g,updateMode:p,...b}=e,f=(0,l.useRef)(null),j=(0,l.useRef)(null),v=()=>{f.current&&(j.current=new a.t1(f.current,{type:u,data:function(e){var t;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,l={labels:[],datasets:[]};return t=e.labels,l.labels=t,c(l,e.datasets,s),l}(m,o),options:h&&{...h},plugins:x}),n(t,j.current))},N=()=>{n(t,null),j.current&&(j.current.destroy(),j.current=null)};return(0,l.useEffect)(()=>{!d&&j.current&&h&&function(e,t){let s=e.options;s&&t&&Object.assign(s,t)}(j.current,h)},[d,h]),(0,l.useEffect)(()=>{if(!d&&j.current){var e,t;e=j.current.config.data,t=m.labels,e.labels=t}},[d,m.labels]),(0,l.useEffect)(()=>{!d&&j.current&&m.datasets&&c(j.current.config.data,m.datasets,o)},[d,m.datasets]),(0,l.useEffect)(()=>{j.current&&(d?(N(),setTimeout(v)):j.current.update(p))},[d,h,m.labels,m.datasets,p]),(0,l.useEffect)(()=>{j.current&&(N(),setTimeout(v))},[u]),(0,l.useEffect)(()=>(v(),()=>N()),[]),l.createElement("canvas",{ref:f,role:"img",height:s,width:i,...b},g)});function d(e,t){return a.t1.register(t),(0,l.forwardRef)((t,s)=>l.createElement(i,{...t,ref:s,type:e}))}let o=d("line",a.ZT),u=d("doughnut",a.ju)}},e=>{var t=t=>e(e.s=t);e.O(0,[5056,3690,6251,7087,3660,2674,272,5647,8376,5927,9740,2675,9038,8640,8441,1517,7358],()=>t(6715)),_N_E=e.O()}]);