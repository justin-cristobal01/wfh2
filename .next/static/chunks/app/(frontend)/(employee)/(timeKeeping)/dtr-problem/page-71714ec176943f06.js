(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{41360:(e,t,s)=>{Promise.resolve().then(s.bind(s,61690))},61690:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var r=s(95155),l=s(58640),a=s(4683),n=s(72757),i=s(92448),d=s(76046),o=s(12115);let c=e=>{let{isOpen:t,onClose:s,record:l,alertMessage:a}=e;if(!t)return null;let n=(0,d.useRouter)(),i=async()=>{try{let e=localStorage.getItem("authToken");if(!e){alert("Authentication failed. Please log in again."),n.push("/");return}if(!(await fetch("/employeeAPI/dtrp",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({id:l.id})})).ok)throw Error("Failed to delete employee");s(),n.push("/dtr-problem")}catch(e){console.error("âŒ Error deleting record:",e),alert("âŒ Error: ".concat(e.message))}};return(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50",children:(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold mb-4 text-gray-700",children:["Delete ",l.type," record?"]}),a&&(0,r.jsxs)("div",{className:"alert alert-warning flex items-center gap-2 p-3 rounded bg-yellow-100 text-yellow-700 border border-yellow-400",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 shrink-0 stroke-current",fill:"none",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,r.jsx)("span",{children:a})]}),(0,r.jsxs)("p",{className:"text-gray-600 mb-4",children:["Are you sure you want to delete ",(0,r.jsxs)("strong",{children:[new Date(l.date).toLocaleDateString()," ",new Date(l.date).toLocaleTimeString("en-GB",{hour12:!0})]}),"?",(0,r.jsx)("br",{}),"This action cannot be undone."]}),(0,r.jsxs)("div",{className:"flex justify-end",children:[(0,r.jsx)("button",{className:"bg-gray-400 text-white px-4 py-2 rounded mr-2",onClick:s,children:"Cancel"}),(0,r.jsx)("button",{className:"bg-red-500 text-white px-4 py-2 rounded",onClick:i,children:"Delete"})]})]})})},u=()=>{let[e,t]=(0,o.useState)(!1),[s,u]=(0,o.useState)(!0),[h,m]=(0,o.useState)(1),[x,p]=(0,o.useState)(1),[g,b]=(0,o.useState)(""),[j,y]=(0,o.useState)(""),[f,w]=(0,o.useState)(""),[v,N]=(0,o.useState)(""),[S,k]=(0,o.useState)(10),[D,E]=(0,o.useState)(null),[C,T]=(0,o.useState)(""),[A,I]=(0,o.useState)(""),[P,R]=(0,o.useState)(null),O=(0,o.useRef)({});(0,d.useRouter)();let[L,F]=(0,o.useState)([]),[B,_]=(0,o.useState)(!1),[z,G]=(0,o.useState)(null),[J,M]=(0,o.useState)("");(0,o.useEffect)(()=>{q();let e=e=>{Object.values(O.current).some(t=>t&&t.contains(e.target))||E(null)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[h,S,C]);let q=async()=>{u(!0);try{let e=JSON.parse(localStorage.getItem("user")||"{}"),t=null==e?void 0:e.employeeId,s=await fetch("/employeeAPI/dtrp?employeeId=".concat(t));if(!s.ok){if(400===s.status)throw Error("User ID is required");if(404===s.status)throw Error("No records found for this user");throw Error("Failed to fetch records")}let r=await s.json();console.log("Fetched Data:",r),F(r),p(r.totalPages)}catch(e){console.error("Error fetching records:",e)}u(!1)},U=e=>{R(e),t(!0),E(null)};return(0,r.jsxs)("div",{className:"min-h-screen shadow-md bg-white",children:[(0,r.jsx)(l.default,{}),C&&(0,r.jsx)("div",{className:"fixed top-4 right-4 p-3 rounded-lg shadow-lg border ".concat("error"===A?"bg-red-600 border-red-800":"bg-green-600 border-green-800"," text-white z-50"),children:C}),(0,r.jsxs)("div",{className:"container mx-auto p-2 mt-2 text-black",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("h1",{children:"Filter By:"}),(0,r.jsxs)("select",{value:g,onChange:e=>b(e.target.value),className:"px-4 py-2 border rounded-md bg-white",children:[(0,r.jsx)("option",{value:"",children:"Select Filter"}),(0,r.jsx)("option",{value:"type",children:"Type"}),(0,r.jsx)("option",{value:"dateRange",children:"Date Range"}),(0,r.jsx)("option",{value:"status",children:"Status"})]}),"dateRange"===g&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{type:"date",value:f,onChange:e=>w(e.target.value),className:"px-4 py-2 border rounded-md bg-white"}),(0,r.jsx)("span",{children:"to"}),(0,r.jsx)("input",{type:"date",value:v,onChange:e=>N(e.target.value),className:"px-4 py-2 border rounded-md bg-white"})]}),(0,r.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-md",children:"Filter"})]}),(0,r.jsxs)("button",{onClick:()=>t(!0),className:"flex items-center bg-blue-600 text-white px-4 py-2 rounded-md",children:[(0,r.jsx)(a.A,{className:"w-5 h-5 mr-2"})," Add"]})]}),(0,r.jsx)("div",{className:"overflow-x-auto h-[420px]",children:(0,r.jsxs)("table",{className:"table table-xs w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-200 sticky top-0",children:[(0,r.jsx)("th",{children:"Date Time"}),(0,r.jsx)("th",{children:"Type"}),(0,r.jsx)("th",{children:"Remarks"}),(0,r.jsx)("th",{children:"Status"}),(0,r.jsx)("th",{children:"Actions"})]})}),(0,r.jsx)("tbody",{children:(null==L?void 0:L.length)>0?L.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsxs)("td",{children:[new Date(e.date).toLocaleDateString()," ",new Date(e.date).toLocaleTimeString("en-GB",{hour12:!0})]}),"time-in"===e.type?(0,r.jsx)("td",{children:(0,r.jsx)("div",{className:"text-primary",children:"Time in"})}):(0,r.jsx)("td",{children:(0,r.jsx)("div",{className:"text-primary",children:"Time out"})}),(0,r.jsx)("td",{children:e.remarks}),"PENDING"===e.status?(0,r.jsx)("td",{children:(0,r.jsx)("div",{className:"text-warning",children:"PENDING"})}):"APPROVED"===e.status?(0,r.jsx)("td",{children:(0,r.jsx)("div",{className:"text-success",children:"APPROVED"})}):(0,r.jsx)("td",{children:(0,r.jsx)("div",{className:"text-error",children:"REJECTED"})}),(0,r.jsx)("td",{className:"relative",children:"PENDING"===e.status&&(0,r.jsxs)("div",{className:"relative",ref:t=>O.current[e.id]=t,children:[(0,r.jsx)("button",{onClick:()=>E(D===e.id?null:e.id),children:(0,r.jsx)(n.A,{})}),D===e.id&&(0,r.jsxs)("div",{className:"absolute left-0 mt-2 bg-white shadow-lg rounded-md border w-32 z-50",children:[(0,r.jsx)("button",{onClick:()=>U(e),className:"block w-full text-left px-4 py-2 hover:bg-gray-200",children:"Edit"}),(0,r.jsx)("button",{onClick:()=>{G(e),_(!0),E(null)},className:"block w-full text-left px-4 py-2 text-red-600 hover:bg-gray-200",children:"Delete"})]})]})})]},e.id)):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:"6",className:"text-center py-4",children:"No records found"})})})]})})]}),(0,r.jsx)(i.default,{isOpen:e,onClose:()=>{t(!1),R(null)},refresh:q,record:P,setMessage:e=>{T(e),setTimeout(()=>{T("")},3e3)}}),(0,r.jsx)(c,{isOpen:B,onClose:()=>{_(!1),q()},record:z,alertMessage:J})]})}},92448:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(95155),l=s(12115);let a=e=>{let{isOpen:t,onClose:s,record:a,refresh:n,setMessage:i}=e,[d,o]=(0,l.useState)(""),[c,u]=(0,l.useState)(""),[h,m]=(0,l.useState)(""),[x,p]=(0,l.useState)(""),[g,b]=(0,l.useState)(!1),[j,y]=(0,l.useState)(""),f=new Date().toISOString().slice(0,10);new Date(f).getTime();let w=e=>new Date(new Date(e).getTime()+288e5).toISOString().slice(0,16);if((0,l.useEffect)(()=>{a?(o(a.type),u(a.date?w(a.date):""),m(a.remarks||""),p(a.reason||"")):(o(""),u(""),m(""),p(""))},[a]),!t)return null;let v=async e=>{if(""===d||""===h)return;if(e.preventDefault(),new Date(f)<=new Date(c)){i("Date time cannot be earlier than today date!"),y("error");return}b(!0),y("");let t=localStorage.getItem("authToken"),r=JSON.parse(localStorage.getItem("user")||"{}"),l=null==r?void 0:r.employeeId,o=a?{id:a.id,type:d,dateTime:c,remarks:h}:{employeeId:l,dateTime:c,type:d,remarks:h};try{if(!(await fetch("/employeeAPI/dtrp?employeeId=".concat(l),{method:a?"PATCH":"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(a?{...o,id:a.id}:o)})).ok)throw Error("Failed to submit Record");void 0!=o.id?i("Record Updated Successfully!"):i("Record Added Successfully!"),n(),s()}catch(e){console.error("Error submitting Record:",e),i("Failed to submit Record.")}finally{b(!1)}};return(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 text-black",children:(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Daily Time Record Problem"}),x&&(0,r.jsx)("div",{className:"text-red-500 mb-2",children:x}),(0,r.jsx)("label",{className:"block mb-2 font-medium",children:"Select Type"}),(0,r.jsxs)("select",{className:"w-full px-4 py-2 border rounded-md mb-4 bg-white",value:d,onChange:e=>o(e.target.value),required:!0,children:[(0,r.jsx)("option",{value:"",children:"Select"}),(0,r.jsx)("option",{value:"time-in",children:"Time In"}),(0,r.jsx)("option",{value:"time-out",children:"Time Out"})]}),(0,r.jsx)("label",{className:"block mb-2 font-medium",children:"Date & Time"}),(0,r.jsx)("input",{type:"datetime-local",className:"w-full px-4 py-2 border rounded-md mb-4 bg-white",value:c,onChange:e=>u(e.target.value)}),(0,r.jsx)("label",{className:"block mb-2 font-medium",children:"Remarks"}),(0,r.jsx)("textarea",{className:"w-full px-4 py-2 border rounded-md mb-4 bg-white",rows:3,placeholder:"Enter remarks...",value:h,onChange:e=>m(e.target.value)}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,r.jsx)("button",{onClick:s,className:"px-4 py-2 bg-red-500 text-white rounded-md",children:"Close"}),(0,r.jsx)("button",{onClick:v,className:"px-4 py-2 bg-green-500 text-white rounded-md",children:g?"Submitting...":a?"Update":"Submit"})]})]})})}},32645:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(14057).A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},72757:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(14057).A)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},4683:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(14057).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[5056,3690,6251,7087,3660,2674,272,8376,5927,9740,9038,8640,8441,1517,7358],()=>t(41360)),_N_E=e.O()}]);