exports.id=9159,exports.ids=[9159],exports.modules={20838:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,13219,23)),Promise.resolve().then(r.t.bind(r,34863,23)),Promise.resolve().then(r.t.bind(r,25155,23)),Promise.resolve().then(r.t.bind(r,40802,23)),Promise.resolve().then(r.t.bind(r,9350,23)),Promise.resolve().then(r.t.bind(r,48530,23)),Promise.resolve().then(r.t.bind(r,88921,23))},6926:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,66959,23)),Promise.resolve().then(r.t.bind(r,33875,23)),Promise.resolve().then(r.t.bind(r,88903,23)),Promise.resolve().then(r.t.bind(r,57174,23)),Promise.resolve().then(r.t.bind(r,84178,23)),Promise.resolve().then(r.t.bind(r,87190,23)),Promise.resolve().then(r.t.bind(r,61365,23))},4:(e,t,r)=>{Promise.resolve().then(r.bind(r,71354))},23972:(e,t,r)=>{Promise.resolve().then(r.bind(r,39246))},22792:(e,t,r)=>{"use strict";r.d(t,{p:()=>l,L:()=>a});var n=r(45512),i=r(58009),o=r(57216);r(50783);let s=({isOpen:e,onClose:t,setMessage:r})=>e?(0,n.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:(0,n.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:[(0,n.jsx)("h2",{className:"text-lg font-bold",children:"Attention!"}),(0,n.jsx)("p",{className:"mt-2",children:r}),(0,n.jsx)("div",{className:"mt-4 flex justify-end",children:(0,n.jsx)("button",{onClick:t,className:"px-4 py-2 bg-blue-500 text-white rounded-lg",children:"Confirm"})})]})}):null,l=(0,i.createContext)(null),a=({children:e})=>{let t=(0,i.useRef)(null),[a,c]=(0,i.useState)(null),[d,u]=(0,i.useState)(!1),[m,h]=(0,i.useState)(null),[g,y]=(0,i.useState)(!1),[p,f]=(0,i.useState)({x:0,y:0}),w=(0,i.useRef)(null),v=(0,i.useRef)(!1),[x,S]=(0,i.useState)(!1),b=(0,i.useRef)(null),E=(0,i.useRef)(new Set),[P,I]=(0,i.useState)(!1);(0,i.useRef)(null);let j=(0,i.useRef)(!1),[k,N]=(0,i.useState)(""),[A,C]=(0,i.useState)(0),[F,M]=(0,i.useState)(0),[D,U]=(0,i.useState)(!1),[L,R]=(0,i.useState)(!1),O=(0,i.useRef)(null),[T,$]=(0,i.useState)(""),[H,W]=(0,i.useState)(""),Y=async()=>{await fetch(`/employerAPI/getEmployeeStatus?employeeId=${k}`,{method:"PUT",headers:{"Content-Type":"application/json"}})},z=async e=>{if(j.current=e,I(!1),e){"Sleeping"===H?(X("User is sleeping","Sleeping"),C(0),U(!1),V()):"Idle"===H&&(X("User is out of area","Idle"),M(0),R(!1),V()),E.current.clear();return}};(0,i.useEffect)(()=>{P&&("Idle"===H?$("Are you still there? Please confirm your presence"):"Sleeping"===H&&$("Are you asleep? Please confirm your presence"),Z())},[P,H]);let[J,q]=(0,i.useState)(()=>({x:0,y:0}));(0,i.useEffect)(()=>{let e=localStorage.getItem("user");if(e)try{let t=JSON.parse(e);N(t.employeeId)}catch(e){console.error("Error parsing user data:",e)}},[]);let X=async(e,t)=>{if(!k){console.warn("Employee ID not found. Skipping update.");return}try{let r=new Date().toISOString(),n=await fetch(`/employeeAPI/humanActivityLog?activity=${t}&employeeId=${k}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({end:r,remarks:e})});if(E.current.clear(),!n.ok)throw Error("Failed to update activity");let i=await n.json();console.log("Activity updated successfully:",i)}catch(e){console.error("❌ Error updating activity:",e)}},G=async e=>{if(!k){console.warn("Employee ID not found. Skipping log.");return}if("Yawning"!==e){if(E.current.has(e)){console.log(`Activity "${e}" already logged. Skipping.`);return}E.current.add(e)}try{let t=new Date().toISOString(),r=null,n=null;if("Yawning"===e&&(r=new Date().toISOString(),n="User is Yawning"),!(await fetch("/employeeAPI/humanActivityLog",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({activity:e,employeeId:k,start:t,end:r,remarks:n})})).ok)throw Error("Failed to log activity")}catch(e){console.error("❌ Error logging activity:",e)}};(0,i.useEffect)(()=>{let e=()=>{q(e=>({x:Math.min(e.x,window.innerWidth-150),y:Math.min(e.y,window.innerHeight-120)}))};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let B=e=>{g&&q(t=>({x:Math.max(0,Math.min(e.clientX-p.x,window.innerWidth-150)),y:Math.max(0,Math.min(e.clientY-p.y,window.innerHeight-120))}))},K=()=>y(!1);(0,i.useEffect)(()=>(window.addEventListener("mousemove",B),window.addEventListener("mouseup",K),()=>{window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",K)}),[g]),(0,i.useEffect)(()=>{(async()=>{try{let e=await r.e(3937).then(r.bind(r,93937));h(e),await o.jh6("webgl"),await o.Gc4(),await Q(e),u(!0)}catch(e){console.error("❌ Error initializing Face API:",e)}})()},[]);let Q=async e=>{try{await e.nets.tinyFaceDetector.loadFromUri("/models"),await e.nets.faceLandmark68Net.loadFromUri("/models"),await e.nets.faceRecognitionNet.loadFromUri("/models"),await e.nets.ssdMobilenetv1.loadFromUri("/models")}catch(e){console.error("❌ Error loading Face API models:",e)}},V=async()=>{try{if(v.current)return;let e=await navigator.permissions.query({name:"camera"});if("denied"===e.state){console.error("❌ Camera access denied by user.");return}a&&(a.getTracks().forEach(e=>e.stop()),c(null));let r=await navigator.mediaDevices.getUserMedia({video:!0});c(r),v.current=!0;let n=async()=>new Promise(e=>{let n=()=>{t.current?(t.current.srcObject=r,e()):requestAnimationFrame(n)};n()});await n()}catch(e){console.error("❌ Error accessing camera:",e)}},Z=()=>{a&&(a.getTracks().forEach(e=>e.stop()),c(null),v.current=!1)},_=async()=>{if(!t.current||!d||!m||!b.current)return;let e=t.current,r=b.current,n=r.getContext("2d"),i=w.current;i&&(r.width=i.clientWidth,r.height=i.clientHeight),n?.clearRect(0,0,r.width,r.height);try{let t=await m.detectSingleFace(e,new m.TinyFaceDetectorOptions).withFaceLandmarks().withFaceDescriptor();if(t&&t.landmarks)L&&P&&(M(0),R(!1));else{console.log("No face detected"),M(e=>{let t=e+1;return console.log(`Idle Timer: ${t}`),!(t>=10)||L||P||(console.log("User is out of area"),G("Idle"),"Idle"!==H&&W("Idle"),R(!0),I(!0)),t});return}let r=t.landmarks,n=r.getMouth()[13];if(r.getMouth()[19].y-n.y>20){let e=Date.now();(!O.current||e-O.current>=5e3)&&(console.log("User is yawning"),G("Yawning"),O.current=e)}let i=r.getLeftEye(),o=r.getRightEye(),s=i[1].y-i[5].y,l=i[3].x-i[0].x,a=s/l,c=o[1].y-o[5].y,d=o[3].x-o[0].x,u=c/d;console.log("left eye: "+a+" right eye: "+u),a>-.28&&u>-.28?C(e=>{let t=e+1;return console.log(`Sleeping Timer: ${t}`),!(t>=10)||D||P||(console.log("User is sleeping"),G("Sleeping"),"Sleeping"!==H&&W("Sleeping"),U(!0),I(!0)),t}):(C(0),D&&P&&U(!1))}catch(e){console.error("❌ Error detecting face:",e)}};return(0,i.useEffect)(()=>{let e=setInterval(()=>{_()},1e3);return()=>clearInterval(e)},[d,m]),(0,n.jsxs)(l.Provider,{value:{videoRef:t,startCamera:V,stopCamera:Z,stream:a},children:[e,a&&(0,n.jsxs)("div",{ref:w,title:"Drag me everywhere or double click me to view larger...",className:"fixed cursor-pointer",style:{left:`${J.x}px`,top:`${J.y}px`,width:x?"300px":"100px",height:x?"280px":"80px",zIndex:1e3},onMouseDown:e=>{y(!0),f({x:e.clientX-J.x,y:e.clientY-J.y})},onDoubleClick:()=>{S(e=>{let t=!e;return t?q({x:(window.innerWidth-200)/2,y:(window.innerHeight-200)/2}):q(e=>({x:Math.min(e.x,window.innerWidth-150),y:Math.min(e.y,window.innerHeight-120)})),t})},children:[(0,n.jsx)("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full border rounded-md shadow-md bg-black"}),(0,n.jsx)("canvas",{ref:b,className:"absolute top-0 left-0"})]}),(0,n.jsx)(s,{isOpen:P,onClose:()=>{z(!0),Y()},refresh:()=>{},setMessage:T})]})}},19150:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(58009);function i(){(0,n.useRef)(null);let[e,t]=(0,n.useState)(null),[r,i]=(0,n.useState)(()=>JSON.parse(localStorage.getItem("user")||"null"));return null}},39246:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var n=r(45512),i=r(85928),o=r.n(i),s=r(92286),l=r.n(s);r(44263);var a=r(22792),c=r(19150),d=r(58009);function u({children:e}){let[t,r]=(0,d.useState)(!1);return(0,n.jsx)("html",{lang:"en",children:(0,n.jsx)("body",{className:`${o().variable} ${l().variable} antialiased`,children:(0,n.jsxs)(a.L,{children:[t&&(0,n.jsx)(c.A,{})," ",e]})})})}},71354:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});let n=(0,r(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\justin\\\\Desktop\\\\vercel\\\\WFH-Monitoring\\\\src\\\\app\\\\layout.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\justin\\Desktop\\vercel\\WFH-Monitoring\\src\\app\\layout.tsx","default")},44263:()=>{}};