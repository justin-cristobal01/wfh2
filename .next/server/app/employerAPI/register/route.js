(()=>{var e={};e.id=7130,e.ids=[7130],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},84518:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>x,routeModule:()=>d,serverHooks:()=>g,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>y});var s={};r.r(s),r.d(s,{GET:()=>c,POST:()=>u});var n=r(42706),o=r(28203),i=r(45994),a=r(39187);let l=new(r(96330)).PrismaClient;async function u(e){try{let t=await e.json();if(console.log("Request body:",t),!t.email)return a.NextResponse.json({error:"Missing Email"},{status:400});if(await l.employeeDetails.findUnique({where:{email:t.email}}))return a.NextResponse.json({error:"Employee with this email already exists"},{status:400});if(!t.scheduleTimein||!t.scheduleTimeout)return a.NextResponse.json({error:"Missing schedule"},{status:400});let r=await l.employeeDetails.create({data:{employeeId:String(t.employeeId),name:t.name,email:t.email,position:t.position,department:t.department,contactNumber:t.contactNumber||null,address:t.address||null,scheduleTimeIn:t.scheduleTimein||null,scheduleTimeOut:t.scheduleTimeout||null}});return a.NextResponse.json(r,{status:201})}catch(e){return console.error("❌ Error registering employee:",e),a.NextResponse.json({error:`Error registering employee: ${e.message||"Unknown error"}`},{status:500})}}let p=async()=>{let e=await l.user.findFirst({orderBy:{id:"desc"}}),t=1;if(e){let e=(await l.user.findMany({select:{employeeId:!0}})).map(e=>parseInt(e.employeeId.replace("EMP",""),10)).filter(e=>!isNaN(e)).sort((e,t)=>t-e);e.length>0&&(t=e[0]+1)}return`EMP${t}`};async function c(){try{await l.$connect(),console.log("✅ Database connection successful!");let e=await p();return a.NextResponse.json({employeeId:e},{status:200})}catch(e){return console.error("❌ Error fetching latest employee ID:",e),a.NextResponse.json({error:"Failed to fetch the latest employee ID",details:e.message},{status:500})}finally{await l.$disconnect()}}let d=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/employerAPI/register/route",pathname:"/employerAPI/register",filename:"route",bundlePath:"app/employerAPI/register/route"},resolvedPagePath:"C:\\Users\\justin\\Desktop\\vercel\\WFH-Monitoring\\src\\app\\employerAPI\\register\\route.tsx",nextConfigOutput:"",userland:s}),{workAsyncStorage:m,workUnitAsyncStorage:y,serverHooks:g}=d;function x(){return(0,i.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:y})}},18868:()=>{},78335:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[638,5452],()=>r(84518));module.exports=s})();